# QLink说明文档
## 1. 地图的生成
### 1.1	游戏的边界
地图是玩家自由移动的区域，同时是整个游戏的边界。所有与地图有关的代码，写在文件objects/map.h和objects/map.cpp中。
### 1.2 地图中的方块
#### **Block Class**
Block（方块）是地图的基本组成部分。
**Public Functions**
const QPixmap& Block::getPic() const;
返回方块的贴图。
qreal Block::getSpeedFactor() const;
返回方块的速度因子，在玩家的运动中，我会详细说明这个概念。
### 1.3 各种方块组成地图
1.2节指出，地图是由各种方块组成的，本节将介绍地图类Map。
#### 地图的几何参数
地图由连续排列的正方形方块组成，为了精确描述地图中所有方块的位置、大小（几何特性），地图中包含了以下成员：
int wScale;
地图的宽度规模（列数）。
int hScale;
地图的高度规模（行数）。
int blockSize;
地图中每个方块的边长。（单位：像素）
QPoint corner;（单位：像素）
地图的左上角坐标，此坐标是以游戏窗口的左上角为原点。
上述成员中，wScale,hScale表示地图的规模，blockSize表示地图的尺寸大小，corner表示地图的位置，这四个成员称为地图Map的**几何参数**。
由于地图中的方块之间没有间隙，确定几何参数的地图中的每个方块的位置、大小都已经确定。在类外引用地图的几何参数时，可以使用Map类对应的接口函数。
由于地图的几何参数在生成地图后一般无需更改，所以可以在构造函数中将它们作为参数传入。
```cpp
Map(int wScale,int hScale,QPoint corner,int blockSize);
```
#### 地图的方块档案
从1.2节中可以看出，单独存在的Block类对象没有意义，需要Map类对象统一管理所有的方块类。正因为如此，Block类将Map类声明为友元类，以便Map对象可以直接管理每个Block对象的成员。在管理的过程中，方块档案是重要的一环。
方块档案是Block指针的容器，原型如下：
```cpp
std::vector<Block*> blocks;
```
方块档案用于存储地图中出现的所有种类的方块。值得注意的是，档案存储的是方块的种类，或者说，是每种方块的信息，而不是地图中的所有方块。方块档案将所有种类的方块按一定顺序存储，这使得每种方块都拥有一个独一无二的编号，那就是它存在档案中的位置（或者下标）。
方块的编号是由放入的顺序决定的，将一些方块放入档案由私有成员函数initBlocks完成，它在Map的构造函数中自动被调用。
#### 地图方块的存储
地图中所有方块逻辑上存储与成员(int**)data指向的动态二维数组中，二维数组中只保存方块的编号，如果要获取方块的其他信息，则需要通过编号访问方块档案对应位置的方块。
在地图构造时，会根据传入的规模参数动态分配堆上空间；地图析构时，动态空间被回收。

## 2.地图上的实体
## 3.时间和分数
## 4.存档和回档
## 5.页面切换逻辑
